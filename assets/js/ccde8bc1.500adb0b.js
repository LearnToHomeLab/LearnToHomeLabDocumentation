"use strict";(globalThis.webpackChunkLearn_To_Homelab=globalThis.webpackChunkLearn_To_Homelab||[]).push([[5046],{1791:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"HomeLab-Series/EP40_SuricataRulesOPNsense","title":"Enabling Suricata Rules on OPNsense Firewall","description":"<div style={{","source":"@site/docs/HomeLab-Series/EP40_SuricataRulesOPNsense.mdx","sourceDirName":"HomeLab-Series","slug":"/HomeLab-Series/EP40_SuricataRulesOPNsense","permalink":"/LearnToHomeLabDocumentation/docs/HomeLab-Series/EP40_SuricataRulesOPNsense","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":42,"frontMatter":{"sidebar_position":42},"sidebar":"tutorialSidebar","previous":{"title":"Move Proxmox VMs & Containers to a New Storage Drive","permalink":"/LearnToHomeLabDocumentation/docs/HomeLab-Series/EP39_MovingProxmoxVMStorage"},"next":{"title":"Upgrade OPNsense ISC DHCP to Dnsmasq and DHCP","permalink":"/LearnToHomeLabDocumentation/docs/HomeLab-Series/EP41_OPNsense ISC DHCP Migration to Dndsmasq DHCP"}}');var i=s(4848),t=s(8453);s(3573),s(6519),s(7286);const l={sidebar_position:42},o="Enabling Suricata Rules on OPNsense Firewall",a={},c=[{value:"Do You Need to Enable Your IPS? (Suricata on OPNsense)?",id:"do-you-need-to-enable-your-ips-suricata-on-opnsense",level:2},{value:"Backup Your OPNsense Firewall First",id:"backup-your-opnsense-firewall-first",level:2},{value:"Enable Emerging Threats (ET) Open Rules in Suricata",id:"enable-emerging-threats-et-open-rules-in-suricata",level:2},{value:"Verify Emerging Threats is Working",id:"verify-emerging-threats-is-working",level:2},{value:"Follow Us on Social Media",id:"follow-us-on-social-media",level:2}];function d(e){const n={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"enabling-suricata-rules-on-opnsense-firewall",children:"Enabling Suricata Rules on OPNsense Firewall"})}),"\n",(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,i.jsx)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/FKOIyv0okC4?si=X79eCYYruEaUS6EP",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),"\n",(0,i.jsx)(n.h2,{id:"do-you-need-to-enable-your-ips-suricata-on-opnsense",children:"Do You Need to Enable Your IPS? (Suricata on OPNsense)?"}),"\n",(0,i.jsxs)(n.p,{children:["Short answer is ",(0,i.jsx)(n.strong,{children:"no"}),", especially if you have no open ports or port forwarding. Suricata inspects ",(0,i.jsx)(n.em,{children:"all"})," network traffic in and out of your network, providing an additional layer of security by spotting vulnerabilities and suspicious activity."]}),"\n",(0,i.jsx)(n.h2,{id:"backup-your-opnsense-firewall-first",children:"Backup Your OPNsense Firewall First"}),"\n",(0,i.jsx)(n.p,{children:"Before changes, always back up:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Log in to your OPNsense machine"}),"\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.strong,{children:"System > Configuration > Backups"})]}),"\n",(0,i.jsxs)(n.li,{children:["Select ",(0,i.jsx)(n.strong,{children:"Download Configuration"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["See the ",(0,i.jsx)(n.a,{href:"https://rules.emergingthreats.net/open/suricata-7.0.3/rules/",children:"Emerging Threats Rules"})," list to know what will be blocked."]}),"\n",(0,i.jsx)(n.h2,{id:"enable-emerging-threats-et-open-rules-in-suricata",children:"Enable Emerging Threats (ET) Open Rules in Suricata"}),"\n",(0,i.jsx)(n.p,{children:"Steps:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Log into OPNsense Web GUI"}),"\n",(0,i.jsxs)(n.li,{children:["Navigate to ",(0,i.jsx)(n.strong,{children:"Services > Intrusion Detection > Administration"})]}),"\n",(0,i.jsxs)(n.li,{children:["Check ",(0,i.jsx)(n.strong,{children:"Enable"})," at top if Suricata is off"]}),"\n",(0,i.jsxs)(n.li,{children:["Also check ",(0,i.jsx)(n.strong,{children:"IPS Mode"})]}),"\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.strong,{children:"Download"})," tab, under ",(0,i.jsx)(n.strong,{children:"Rule Sets"})]}),"\n",(0,i.jsxs)(n.li,{children:["Enable ",(0,i.jsx)(n.strong,{children:"Emerging Threats Open"})," rule sets (enable what you need; more rules use more resources)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Common recommended rule categories:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Category Name"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Why Enable?"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"emerging-exploit"}),(0,i.jsx)(n.td,{children:"Detect exploits against vulnerabilities"}),(0,i.jsx)(n.td,{children:"Captures common attack vectors on patchable software"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"emerging-malware"}),(0,i.jsx)(n.td,{children:"Malware communications and payloads"}),(0,i.jsx)(n.td,{children:"Blocks malware control and payload communication"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"emerging-scan"}),(0,i.jsx)(n.td,{children:"Network scanning detection"}),(0,i.jsx)(n.td,{children:"Detects attackers probing your network"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"emerging-phishing"}),(0,i.jsx)(n.td,{children:"Phishing URL and traffic detection"}),(0,i.jsx)(n.td,{children:"Prevents credential theft and social engineering"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"emerging-dos"}),(0,i.jsx)(n.td,{children:"Denial-of-service attack detection"}),(0,i.jsx)(n.td,{children:"Detects volume or targeted DoS attacks"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"emerging-attack_response"}),(0,i.jsx)(n.td,{children:"Post-exploitation attacker behavior"}),(0,i.jsx)(n.td,{children:"Spots lateral movement or persistence"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"emerging-botcc*"}),(0,i.jsx)(n.td,{children:"Botnet command & control"}),(0,i.jsx)(n.td,{children:"Prevents infected hosts from communicating with attackers"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"emerging-web_server"}),(0,i.jsx)(n.td,{children:"Web server attack prevention"}),(0,i.jsx)(n.td,{children:"Protects vulnerable web apps"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"emerging-ftp/smtp/dns/pop3"}),(0,i.jsx)(n.td,{children:"Protocol-specific attacks"}),(0,i.jsx)(n.td,{children:"Covers common service attack vectors"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"emerging-snmp"}),(0,i.jsx)(n.td,{children:"SNMP protocol abuses"}),(0,i.jsx)(n.td,{children:"Detects infrastructure misuses"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"emerging-sql"}),(0,i.jsx)(n.td,{children:"SQL Injection and DB attacks"}),(0,i.jsx)(n.td,{children:"Protects against database attacks"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"*If available in your rule set."}),"\n",(0,i.jsxs)(n.ol,{start:"7",children:["\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Enable selected"})]}),"\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.strong,{children:"Rules"})," tab \u2192 ",(0,i.jsx)(n.strong,{children:"Rules"}),", enable rules as required"]}),"\n",(0,i.jsxs)(n.li,{children:["Schedule automatic updates weekly under ",(0,i.jsx)(n.strong,{children:"Schedule"})," tab:"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Minutes: 0"}),"\n",(0,i.jsx)(n.p,{children:"Hours: 0"}),"\n",(0,i.jsx)(n.p,{children:"Day of the month: 1"}),"\n",(0,i.jsx)(n.p,{children:"Months: *"}),"\n",(0,i.jsx)(n.p,{children:"Days of the week: *"}),"\n",(0,i.jsxs)(n.ol,{start:"10",children:["\n",(0,i.jsx)(n.li,{children:"Save and apply changes."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"verify-emerging-threats-is-working",children:"Verify Emerging Threats is Working"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Enable SSH under ",(0,i.jsx)(n.strong,{children:"System > Settings > Administration"})]}),"\n",(0,i.jsx)(n.li,{children:"SSH into OPNsense:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"ssh <username>@<opnsense_ip>\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Select option 8 for shell"}),"\n",(0,i.jsx)(n.li,{children:"Run:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"curl http://testmynids.org/uid/index.html\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsxs)(n.li,{children:["Check logs at ",(0,i.jsx)(n.strong,{children:"Services > Intrusion Detection > Administration > Alerts"})," in the OPNsense dashboard"]}),"\n",(0,i.jsx)(n.li,{children:"Disable SSH in OPNsense dashboard if no longer needed."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Suricata now monitors your traffic using community-maintained Emerging Threats Open threat signatures."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"follow-us-on-social-media",children:"Follow Us on Social Media"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://www.youtube.com/@learntohomelab",children:"YouTube"}),(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://discord.gg/6MsHSJWZpH",children:"Discord"}),(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://www.patreon.com/c/learntohomelab",children:"Patreon"}),(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://www.reddit.com/r/learntohomelab/",children:"Reddit"}),(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://rumble.com/c/c-7585051",children:"Rumble"})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);