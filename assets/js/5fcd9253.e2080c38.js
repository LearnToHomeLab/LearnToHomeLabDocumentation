"use strict";(globalThis.webpackChunkLearn_To_Homelab=globalThis.webpackChunkLearn_To_Homelab||[]).push([[9526],{3573:(e,i,n)=>{n.d(i,{A:()=>s});n(6540);var o=n(4848);function s({icon:e="\u26a0\ufe0f",title:i,children:n}){return(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",backgroundColor:"#e4141e",color:"white",padding:"20px",borderRadius:"10px",marginBottom:"20px"},children:[(0,o.jsx)("div",{style:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"white",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"28px",marginRight:"15px",flexShrink:0,lineHeight:"50px",textAlign:"center"},children:(0,o.jsx)("span",{style:{display:"inline-block",lineHeight:"1",verticalAlign:"middle"},children:e})}),(0,o.jsxs)("div",{children:[i&&(0,o.jsx)("h3",{style:{margin:0,marginBottom:"10px",color:"white"},children:i}),n]})]})}},6519:(e,i,n)=>{n.d(i,{A:()=>s});n(6540);var o=n(4848);function s({emoji:e,title:i,children:n}){return(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",backgroundColor:"#8CD2F4",color:"black",padding:"20px",borderRadius:"10px",marginBottom:"20px"},children:[(0,o.jsx)("div",{style:{width:"100px",height:"50px",borderRadius:"50%",backgroundColor:"white",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"20px",marginRight:"15px"},children:e}),(0,o.jsxs)("div",{children:[i&&(0,o.jsx)("h3",{style:{margin:0,marginBottom:"10px"},children:i}),n]})]})}},6819:(e,i,n)=>{n.d(i,{A:()=>l});var o=n(6540),s=n(1470),t=(n(5182),n(4848));const r="/LearnToHomeLabDocumentation";function l({folder:e="images/start-guide",name:i,alt:n="",className:l="",...a}){const[d,h]=(0,o.useState)(!1),c=`${r}/${e}/${i}`;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{src:c,alt:n,className:l,style:{cursor:"pointer",maxWidth:"100%"},onClick:()=>h(!0),...a}),(0,t.jsx)(s.Ay,{open:d,close:()=>h(!1),slides:[{src:c,alt:n}]})]})}},8307:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>o,toc:()=>h});const o=JSON.parse('{"id":"HomeLab-Series/EP7_setuppihole","title":"Set up Pi-Hole With Proxmox (Network Wide Ad Blocker)","description":"In this episode we will cover how to set up Pi-Hole (a network-wide ad blocker), using Proxmox, assigning your Pi-Hole server a static IP address, and adding to the block list to increase its effectiveness.","source":"@site/docs/HomeLab-Series/EP7_setuppihole.mdx","sourceDirName":"HomeLab-Series","slug":"/HomeLab-Series/EP7_setuppihole","permalink":"/LearnToHomeLabDocumentation/docs/HomeLab-Series/EP7_setuppihole","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10},"sidebar":"tutorialSidebar","previous":{"title":"Setting up your first Video Game Server (Minecraft Example)!","permalink":"/LearnToHomeLabDocumentation/docs/HomeLab-Series/EP6_firstvideogameserver"},"next":{"title":"NextCloud Setup inside of Proxmox","permalink":"/LearnToHomeLabDocumentation/docs/HomeLab-Series/EP8_nextcloud"}}');var s=n(4848),t=n(8453),r=(n(3573),n(6519),n(6819));const l={sidebar_position:10},a="Set up Pi-Hole With Proxmox (Network Wide Ad Blocker)",d={},h=[{value:"What you need to get started",id:"what-you-need-to-get-started",level:2},{value:"Create a VM for your Pi-Hole instances",id:"create-a-vm-for-your-pi-hole-instances",level:2},{value:"Installing Pi-Hole",id:"installing-pi-hole",level:2},{value:"Changing our DNS settings",id:"changing-our-dns-settings",level:2},{value:"Set a Static IP address in OPNsense",id:"set-a-static-ip-address-in-opnsense",level:2},{value:"Configuring Pi-Hole",id:"configuring-pi-hole",level:2},{value:"Adding blocklists to Pi-Hole",id:"adding-blocklists-to-pi-hole",level:2},{value:"Changing your DNS upstream servers",id:"changing-your-dns-upstream-servers",level:2},{value:"Follow Us on Social Media",id:"follow-us-on-social-media",level:2}];function c(e){const i={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"set-up-pi-hole-with-proxmox-network-wide-ad-blocker",children:"Set up Pi-Hole With Proxmox (Network Wide Ad Blocker)"})}),"\n",(0,s.jsx)(i.p,{children:"In this episode we will cover how to set up Pi-Hole (a network-wide ad blocker), using Proxmox, assigning your Pi-Hole server a static IP address, and adding to the block list to increase its effectiveness."}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,s.jsx)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/JfFghRmxMME?si=zAVfX6sKS1q-UsC7",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"what-you-need-to-get-started",children:"What you need to get started"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsx)(i.li,{children:"Login to your Proxmox server."}),"\n",(0,s.jsxs)(i.li,{children:["Go to Pi-hole's website ",(0,s.jsx)(i.a,{href:"https://pi-hole.net/",children:"here"})]}),"\n",(0,s.jsx)(i.li,{children:"Login to your OPNsense firewall (or home router)."}),"\n",(0,s.jsxs)(i.li,{children:["Check this site out for more block lists that we will add to Pi-Hole ",(0,s.jsx)(i.a,{href:"https://firebog.net/",children:"here"})]}),"\n",(0,s.jsxs)(i.li,{children:["Here is CloudFlares site with the alternative DNS options for advanced malware and Adult Content filtering ",(0,s.jsx)(i.a,{href:"https://blog.cloudflare.com/introducing-1-1-1-1-for-families/",children:"here"})]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["First you guys need to open your Proxmox machine and create a new VM for Pihole using Ubuntu (please see our video on how to setup your first VM) if you are unsure how to do this ",(0,s.jsx)(i.a,{href:"/LearnToHomeLabDocumentation/docs/HomeLab-Series/EP5_firstvmubuntu",children:"here"}),(0,s.jsx)(i.br,{}),"\n","We used default settings, 2GB of ram, 32gb, and 2v cores."]}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.3.1.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"Next Go to Piholes website and click install:"}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.3.3.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.h2,{id:"create-a-vm-for-your-pi-hole-instances",children:"Create a VM for your Pi-Hole instances"}),"\n",(0,s.jsxs)(i.p,{children:["Then log into your Opnsense Machine and go to the menu ",(0,s.jsx)(i.em,{children:"System / Settings / General"})," tab. If you are doing this on your home router you will need to find where your DNS settings are stored."]}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.3.4.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.h2,{id:"installing-pi-hole",children:"Installing Pi-Hole"}),"\n",(0,s.jsx)(i.p,{children:"Next you need to login to your freshly created VM that we are going to install Pi-Hole on using the SSH command:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"ssh username@VM_ip-address\n"})}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.3.5.png",alt:"Description of your image"}),"\n",(0,s.jsxs)(i.p,{children:["Next we are going to go over to the download Github page we were directed to when we clicked download on Pi-holes site, copy the ",(0,s.jsx)(i.em,{children:"One-Step Automated Install"})," command:"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"curl -sSL https://install.pi-hole.net | bash\n"})}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.3.6.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"We are going to go back to our SSH session and paste this command in:"}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.3.7.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"The following steps are very self-explanatory but just follow the install Wizard all the way through without changing anything other then the following examples:"}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.3.8.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"We will set the static IP address later in this article within OPNsense!"}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.3.9.png",alt:"Description of your image"}),"\n",(0,s.jsxs)(i.p,{children:["You can select CloudFlares DNS for right now (it is what we suggest for the fasted resolution times).",(0,s.jsx)(i.br,{}),"\n","After that, just follow the rest of the wizard with all ",(0,s.jsx)(i.em,{children:"oks"})," or ",(0,s.jsx)(i.em,{children:"continues"})]}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.3.10.png",alt:"Description of your image"}),"\n",(0,s.jsxs)(i.p,{children:["You will then be presented with this screen, click enter to ",(0,s.jsx)(i.em,{children:"ok"})," and we will be presented with another screen that also gives us the URL and password to login."]}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.4.1.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"Here is that other screen with a clickable link:"}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.4.2.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"Now login to your Pi-Hole instance."}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.4.3.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.h2,{id:"changing-our-dns-settings",children:"Changing our DNS settings"}),"\n",(0,s.jsxs)(i.p,{children:["Now we need to change our DNS settings. If you forgot, go to the following menu as shown below ",(0,s.jsx)(i.em,{children:"System / Settings / General"})," tab.",(0,s.jsx)(i.br,{}),"\n","Then input your Pi-Hole servers IP address into the following two dns boxes and then scroll down and select ",(0,s.jsx)(i.em,{children:"save"}),"."]}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.5.2.png",alt:"Description of your image"}),"\n",(0,s.jsxs)(i.p,{children:["We need to add our Pi-Hole's IP address to one more DNS record found under ",(0,s.jsx)(i.em,{children:"services / ISC DHCPv4 / [LAN]"})," then scroll down and select save as well."]}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.5.3.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.h2,{id:"set-a-static-ip-address-in-opnsense",children:"Set a Static IP address in OPNsense"}),"\n",(0,s.jsxs)(i.p,{children:["Now right under the LAN section is ",(0,s.jsx)(i.em,{children:"leases"})," this is where we set the static IP address for our Pi-Hole Machine."]}),"\n",(0,s.jsxs)(i.p,{children:["Find the IP address of your machine and click the ",(0,s.jsx)(i.em,{children:"+"})," icon next to it"]}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.6.1.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"You will be presented with this screen where you will set the IP address to the IP address that was already assigned to your machine via DHCP and give it a name."}),"\n",(0,s.jsxs)(i.p,{children:["Scroll down and click ",(0,s.jsx)(i.em,{children:"save"})]}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.7.1.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"After selecting save, we will be kicked over to this menu, scroll down to the bottom and confirm your Pi-Hole instance has a static address."}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.7.2.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.h2,{id:"configuring-pi-hole",children:"Configuring Pi-Hole"}),"\n",(0,s.jsx)(i.p,{children:"Moving back over to our Pi-Hole machine we logged into a few steps ago, we are presented with the landing page, we can see in blue, we have no hosts or any blocks yet."}),"\n",(0,s.jsx)(i.p,{children:"DNS takes roughly 15 minutes to spread through a small network but we can speed that up with some following commands."}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.7.3.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"To speed the process up first let me show you what it looked like BEFORE:"}),"\n",(0,s.jsx)(i.p,{children:"Our DNS server was set to 192.168.50.1 NOT the 192.168.50.241 of our Pi-Hole machine."}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.7.4.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"To quickly verify and resolve to the new DNS server we can perform the following commands:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"ipconfig /flushdns\n"})}),"\n",(0,s.jsx)(i.p,{children:"and"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"ipconfig /renew\n"})}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.7.5.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"Then we can check our DNS servers one more time using"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"ipconfig /all\n"})}),"\n",(0,s.jsx)(i.p,{children:"here we can see it has changed to our Pi-Hole machine."}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.7.6.png",alt:"Description of your image"}),"\n",(0,s.jsxs)(i.p,{children:["We can also go back to Pi-Hole and select the blue ",(0,s.jsx)(i.em,{children:"total quaries"})," icon on the front page and find our device in there, if it is now green we know the machine is using Pi-Hole for DNS."]}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.8.1.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"Now on the front page we can see queries taking place as well as blocks occurring!"}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.8.2.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.h2,{id:"adding-blocklists-to-pi-hole",children:"Adding blocklists to Pi-Hole"}),"\n",(0,s.jsxs)(i.p,{children:["If you would like to add more blocklists fireborg is a great website to do that which can be found ",(0,s.jsx)(i.a,{href:"https://firebog.net/",children:"here"})]}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.8.3.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.p,{children:"You will then copy and paste those URLs into Pi-Hole under the Adlist tab."}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.8.4.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.h2,{id:"changing-your-dns-upstream-servers",children:"Changing your DNS upstream servers"}),"\n",(0,s.jsx)(i.p,{children:"If you would like to use a custom self-hosted Unbound DNS server or a more advanced CloudFlare DNS server like one which increases malware protection or adult content filtering, this is the page to do that."}),"\n",(0,s.jsx)(i.p,{children:"You will unselect the CDNs on the left and select the custom ones on the right and then input the IP addresses for your new upstream DNS server."}),"\n",(0,s.jsx)(i.p,{children:"We recommend the following CloudFlare DNS servers for added features:"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Malware Blocking Only"})}),"\n",(0,s.jsx)(i.p,{children:"Primary DNS:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"1.1.1.2\n"})}),"\n",(0,s.jsx)(i.p,{children:"Secondary DNS:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"1.0.0.2\n"})}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Malware and Adult Content"}),"\r\nPrimary DNS:"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"1.1.1.3\n"})}),"\n",(0,s.jsx)(i.p,{children:"Secondary DNS:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"1.0.0.3\n"})}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.8.5.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.h1,{id:"closing-thoughts",children:"Closing Thoughts"}),"\n",(0,s.jsxs)(i.p,{children:["That is it, you have set up your Pi-Hole network wide add blocker! We do however recommend you pair this with a host based ad blocker as well. The one we recommend can be found ",(0,s.jsx)(i.a,{href:"https://getadblock.com/en/",children:"here"})]}),"\n",(0,s.jsx)(r.A,{folder:"images/EP7_pihole",name:"Still 2024-12-23 115344_1.9.1.png",alt:"Description of your image"}),"\n",(0,s.jsx)(i.h2,{id:"follow-us-on-social-media",children:"Follow Us on Social Media"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.a,{href:"https://www.youtube.com/@learntohomelab",children:"YouTube"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.a,{href:"https://discord.gg/6MsHSJWZpH",children:"Discord"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.a,{href:"https://www.patreon.com/c/learntohomelab",children:"Patreon"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.a,{href:"https://www.reddit.com/r/learntohomelab/",children:"Reddit"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.a,{href:"https://rumble.com/c/c-7585051",children:"Rumble"})})]})}function p(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);