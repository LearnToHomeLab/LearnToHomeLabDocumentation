"use strict";(globalThis.webpackChunkLearn_To_Homelab=globalThis.webpackChunkLearn_To_Homelab||[]).push([[1274],{5072:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"HomeLab-Series/EP8_nextcloud","title":"NextCloud Setup inside of Proxmox","description":"In this episode, we are going to cover how to set up a NextCloud server (container) within Proxmox Virtual environment in just a few clicks using TurnKey.","source":"@site/docs/HomeLab-Series/EP8_nextcloud.mdx","sourceDirName":"HomeLab-Series","slug":"/HomeLab-Series/EP8_nextcloud","permalink":"/docs/HomeLab-Series/EP8_nextcloud","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"sidebar_position":11},"sidebar":"tutorialSidebar","previous":{"title":"Set up Pi-Hole With Proxmox (Network Wide Ad Blocker)","permalink":"/docs/HomeLab-Series/EP7_setuppihole"},"next":{"title":"Installing Tailscale on Proxmox","permalink":"/docs/HomeLab-Series/EP9_tailscale"}}');var i=n(4848),s=n(8453),r=(n(3573),n(6519),n(7286));const a={sidebar_position:11},l="NextCloud Setup inside of Proxmox",c={},d=[{value:"Back Story",id:"back-story",level:2},{value:"Install Steps",id:"install-steps",level:2},{value:"Nextcloud Install Wizard",id:"nextcloud-install-wizard",level:2},{value:"Login on your phone",id:"login-on-your-phone",level:2},{value:"Closing comments",id:"closing-comments",level:2},{value:"Follow Us on Social Media",id:"follow-us-on-social-media",level:2}];function u(e){const o={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.header,{children:(0,i.jsx)(o.h1,{id:"nextcloud-setup-inside-of-proxmox",children:"NextCloud Setup inside of Proxmox"})}),"\n",(0,i.jsxs)(o.p,{children:["In this episode, we are going to cover how to set up a NextCloud server (container) within Proxmox Virtual environment in just a few clicks using TurnKey.",(0,i.jsx)(o.br,{}),"\n","These container templates come with Proxmox already, making it a super simple task to have a network-wide backup server for your pictures and documents."]}),"\n",(0,i.jsx)(o.h2,{id:"back-story",children:"Back Story"}),"\n",(0,i.jsxs)(o.p,{children:["Learn from me: my wife and I went on an honeymoon cruise to The Bahamas and virtually have NO pictures of our trip because our phones got water damaged! Backing up your pictures at the end of each day to your NextCloud server could save you much heartache! We learned, though, that our Europe trip of 2024 was full of me backing up our content daily! ",(0,i.jsx)(o.em,{children:"This Episode won't cover how to back up your content outside of your network, but our TailScale episode will!"})]}),"\n",(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,i.jsx)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/SbGSgMMt6gg?si=lPlB3rZp0Svq9eyk",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),"\n",(0,i.jsx)(o.h2,{id:"install-steps",children:"Install Steps"}),"\n",(0,i.jsx)(o.p,{children:"First log into Proxmox and go to:"}),"\n",(0,i.jsxs)(o.ol,{children:["\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.em,{children:"server"})," / ",(0,i.jsx)(o.em,{children:"local (pve)"})," (or whatever your server name is)"]}),"\n",(0,i.jsxs)(o.li,{children:["/ ",(0,i.jsx)(o.em,{children:"CT Templates"})," / ",(0,i.jsx)(o.em,{children:"Templates"})]}),"\n"]}),"\n",(0,i.jsxs)(o.p,{children:["and then search for Nextcloud and select download! Wait for that ",(0,i.jsx)(o.em,{children:"Task OK"})," and move on with the next steps!"]}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.3.1.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Now we are going to click create CT on the top right of our environment and follow the creation wizard for our container."}),"\n",(0,i.jsx)(o.p,{children:"The general tab password is for the containers root user. The container default username is root and then the password you set."}),"\n",(0,i.jsxs)(o.p,{children:["I am not going to show every tab, but you can see from the image below there is general, templates, etc. We are concerned about the templates tab where you will select nextcloud, the ",(0,i.jsx)(o.em,{children:"Disks"})," tab SET THIS AS HIGH AS YOU CAN. This determines how many pictures you can save., and then under the network tab we need to set a static IP address for our machine. We need to ensure in OPNsense or your router that the IP you are assigning has not already been issued to another machine."]}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.4.1.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"We can verify what FREE IP addresses we have by opening OPNsense and going to (Services / ISC DHCPv4 / [LAN] & Leases) tabs. As long as you do not see either one of those tabs with the IP you want to use, you are good to assign the container that address."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.7.1.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Going back to Proxmox we can see we have moved all the way to the Network Tab. AGAIN, do not forget to assign the proper disk space to save images and the other CPU and memory tab could be left default if you want."}),"\n",(0,i.jsx)(o.p,{children:"Now assign the IPv4 address you have chosen and ensure you add your networks CIDR notation to the end. 99% of you it will be a /24 for a basic home network."}),"\n",(0,i.jsx)(o.p,{children:"Then assign the gateway which is the IP of your home router or OPNsense box."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.8.1.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Here is an overview of my Containers settings. Disk is not shown but again make sure you make that nice and big so you can save loads of images. You will probably want somewhere in the ballpark of 100Gbs+."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.8.2.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.h2,{id:"nextcloud-install-wizard",children:"Nextcloud Install Wizard"}),"\n",(0,i.jsx)(o.p,{children:"Select your container from the right menu, you will notice containers sit above Virtual Machines so make sure you aren't missing it!"}),"\n",(0,i.jsx)(o.p,{children:"Under the console tab click start, and after boot login with:"}),"\n",(0,i.jsxs)(o.p,{children:["Username: Root",(0,i.jsx)(o.br,{}),"\n","Password: (the one you set on the general tabs page of container creation)"]}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.9.1.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Login screen image:"}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.9.2.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Soon as you login you will be prompted by the NextCloud install wizard."}),"\n",(0,i.jsx)(o.p,{children:"Follow the wizard through, it is very explanatory, and you are really creating passwords for accounts."}),"\n",(0,i.jsx)(o.p,{children:"Keep these account passwords stored in your notes for later!"}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.9.3.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Nextcloud Admin (YOU WILL LOGIN WITH THIS ONE!)"}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.9.4.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"You can skip this one, we are not going to access Nextcloud with a URL."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.9.5.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"We are not going to use Turnkey backup so you can click your tab key twice and then enter for skip."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.9.6.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"You can enter an email here for notifications if you'd like."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.9.7.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Always ensure you have the latest security updates so click install."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.9.8.png",alt:"Description of your image"}),"\n",(0,i.jsxs)(o.p,{children:["At this point you have reached the end, copy this info into your notes and then you can do ",(0,i.jsx)("kbd",{children:"ctrl"})," + ",(0,i.jsx)("kbd",{children:"enter"})," to exit the menu."]}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.10.1.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Going to the Nextcloud IP address in our browser we can see there is a security feature that prevents us from accessing it:"}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.11.1.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"If click documentation we are taken to this page that gives us some insight on how to fix this."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.11.2.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"We need to go into the following settings directory to make the correct changes."}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{children:"nano /var/www/nextcloud/config/config.php\n"})}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.11.3.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"You will be presented with the following file and we are going to edit the following 'trusted_domains' section."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.11.4.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"We want to make that section in ours look like this:"}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{children:"'trusted_domains' =>\r\narray (\r\n0 => 'localhost',\r\n1 => '192.168.50.20',\r\n),\n"})}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.11.5.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Now we can go back to the site and login:"}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.11.6.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Before we continue, we need to set the static IP address of our NextCloud container in OPnsense."}),"\n",(0,i.jsx)(o.p,{children:"First let's grab the Mac address of our container under our container network settings location. Select the network card and click edit, then copy the MAC."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.16.1.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Now go over to OPNsense and we can create a static listing under Services / ISC DHCPv4 / [LAN] and selecting the + button."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.12.1.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Now we can take that MAC address and our IP address and add it into our static assignment. Then click save."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.16.2.png",alt:"Description of your image"}),"\n",(0,i.jsxs)(o.p,{children:["Going back over to Nextcloud after you logged in, we can use the ",(0,i.jsx)(o.em,{children:"new"})," button to create new folders or upload a file to the current folder you are in."]}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.16.3.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.h2,{id:"login-on-your-phone",children:"Login on your phone"}),"\n",(0,i.jsx)(o.p,{children:"Download the NextCloud app and you can connect to your server using that IP address just like you did in your browser."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.17.1.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Select yes on the certificate, we trust it because it's our certificate!"}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.17.2.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Then you can login."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.17.3.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Now you're connected, go back over to your app to use NextCloud."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.18.1.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.p,{children:"Then we can use the + button just like the site and upload pictures or create folders."}),"\n",(0,i.jsx)(r.A,{folder:"images/EP8_nextcloud",name:"Still 2024-12-30 112738_1.20.2.png",alt:"Description of your image"}),"\n",(0,i.jsx)(o.h2,{id:"closing-comments",children:"Closing comments"}),"\n",(0,i.jsx)(o.p,{children:"That is it, I hope you guys enjoyed! In a later episode we will cover Tailscale and how to access your NextCloud from outside your network."}),"\n",(0,i.jsx)(o.h2,{id:"follow-us-on-social-media",children:"Follow Us on Social Media"}),"\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.a,{href:"https://www.youtube.com/@learntohomelab",children:"YouTube"})}),"\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.a,{href:"https://discord.gg/6MsHSJWZpH",children:"Discord"})}),"\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.a,{href:"https://www.patreon.com/c/learntohomelab",children:"Patreon"})}),"\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.a,{href:"https://www.reddit.com/r/learntohomelab/",children:"Reddit"})}),"\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.a,{href:"https://rumble.com/c/c-7585051",children:"Rumble"})})]})}function h(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}}}]);