"use strict";(globalThis.webpackChunkLearn_To_Homelab=globalThis.webpackChunkLearn_To_Homelab||[]).push([[5395],{1364:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>p,frontMatter:()=>a,metadata:()=>o,toc:()=>h});const o=JSON.parse('{"id":"HomeLab-Series/EP42_CloudPanel","title":"CloudPanel Install","description":"<div style={{","source":"@site/docs/HomeLab-Series/EP42_CloudPanel.mdx","sourceDirName":"HomeLab-Series","slug":"/HomeLab-Series/EP42_CloudPanel","permalink":"/docs/HomeLab-Series/EP42_CloudPanel","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":44,"frontMatter":{"sidebar_position":44},"sidebar":"tutorialSidebar","previous":{"title":"Upgrade OPNsense ISC DHCP to Dnsmasq and DHCP","permalink":"/docs/HomeLab-Series/EP41_OPNsense ISC DHCP Migration to Dndsmasq DHCP"},"next":{"title":"Software Tutorials","permalink":"/docs/category/software-tutorials"}}');var s=l(4848),r=l(8453),t=l(3573),i=(l(6519),l(7286));const a={sidebar_position:44},d="CloudPanel Install",c={},h=[{value:"Where to find things for the video:",id:"where-to-find-things-for-the-video",level:2},{value:"What you need for this tutorial",id:"what-you-need-for-this-tutorial",level:2},{value:"Install CloudPanel",id:"install-cloudpanel",level:2},{value:"Access CloudPanel",id:"access-cloudpanel",level:2},{value:"CloudFlare Tunnels",id:"cloudflare-tunnels",level:2},{value:"Blocking WordPress Admin from the Public Internet",id:"blocking-wordpress-admin-from-the-public-internet",level:2},{value:"Testing our Wordpress wp-admin firewall rule",id:"testing-our-wordpress-wp-admin-firewall-rule",level:2},{value:"Getting local Wordpress wp-admin Access",id:"getting-local-wordpress-wp-admin-access",level:2},{value:"Follow Us on Social Media",id:"follow-us-on-social-media",level:2}];function u(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"cloudpanel-install",children:"CloudPanel Install"})}),"\n",(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,s.jsx)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/d5ktpgmrD-Q?si=2Bb08K1ggGHMwi0z",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),"\n",(0,s.jsxs)(n.p,{children:["All notes found in this video for CloudPanel come from the following documentation ",(0,s.jsx)(n.a,{href:"https://www.cloudpanel.io/docs/v2/getting-started/other/",children:"here"})]}),"\n",(0,s.jsx)(n.h2,{id:"where-to-find-things-for-the-video",children:"Where to find things for the video:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"SSL/TLS / Overview (shows the current encryption standard)"}),"\n",(0,s.jsx)(n.li,{children:"Account Home (not in zero trust) select the domain name, 3 dots, configure DNS / DNS / Records (shows the CNAME and A records for the domain)"}),"\n",(0,s.jsx)(n.li,{children:"Networks / Tunnels (Where you edit your Tunnels)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"what-you-need-for-this-tutorial",children:"What you need for this tutorial"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"CloudFlare account with a CloudFlare owned domain name"}),"\n",(0,s.jsx)(n.li,{children:"Router/Firewall (OPNsense for example or a router that allows for local DNS setting overrides)"}),"\n",(0,s.jsx)(n.li,{children:"Virtualization (Proxmox, VMware, XCP-NG, etc.) for two virtual machines (VM\u2019s)"}),"\n",(0,s.jsx)(n.li,{children:"Motivation to be the best homelabber you can be!"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"install-cloudpanel",children:"Install CloudPanel"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Create a VM on Proxmox (or your virtualization platform)CloudPanel asks for at least 1 core and 2 gigabytes of RAM. I would say do at least 2 cores and 4 gigabytes of ram in my experience"}),"\n",(0,s.jsx)(n.hr,{}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Follow the steps below to install CloudPanel after creating your VM"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"the first step we want to do is update our machine with the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo apt update && sudo apt -y upgrade && sudo apt -y install curl wget \r\nsudo\n"})}),"\n",(0,s.jsx)(n.p,{children:"Next we are going to use the following install command meant for Ubuntu 24.04 LTS. If you are on a different version please check their documentation with the link at the start of this article."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'curl -sS https://installer.cloudpanel.io/ce/v2/install.sh -o install.sh; \\\r\necho "19cfa702e7936a79e47812ff57d9859175ea902c62a68b2c15ccd1ebaf36caeb\r\ninstall.sh" | \\\r\nsha256sum -c && sudo DB_ENGINE=MYSQL_8.4 bash install.sh\n'})}),"\n",(0,s.jsx)(n.h2,{id:"access-cloudpanel",children:"Access CloudPanel"}),"\n",(0,s.jsx)(n.p,{children:"You can now access CloudPanel via Browser:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"https://yourIpAddress:8443\n"})}),"\n",(0,s.jsx)(n.p,{children:"After you create an account / Login, select SITES and + ADD SITE"}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"add site.png",alt:"adds a new site in cloudpanel"}),"\n",(0,s.jsx)(n.p,{children:"Select CREATE A WORDPRESS SITE"}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"site selection.png",alt:"select type of site you want to make in cloudpanel"}),"\n",(0,s.jsx)(n.p,{children:"Fill out the information seen below, the domain name will be the FQDN (example: Wordpresssite.com) of your CloudFlare owned domain name, then click create."}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"new word press site info.png",alt:"Wordpress site info"}),"\n",(0,s.jsx)(t.A,{children:(0,s.jsx)(n.p,{children:"IMPORTANT"})}),"\n",(0,s.jsx)(n.p,{children:"Ensure you copy this page, you will need the wordpress login credentials!"}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"login credentials.png",alt:"Wordpress login credentials"}),"\n",(0,s.jsx)(n.h2,{id:"cloudflare-tunnels",children:"CloudFlare Tunnels"}),"\n",(0,s.jsx)(n.p,{children:"We need to create another VM or LXC container to run CloudFlare Tunnels (THIS IS VERY important, this will allow us to BLOCK public internet access to the WordPress admin page)."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Create a VM (IF you are installing this on a CT you will need to perform a couple commands before following their install script)"}),"\n",(0,s.jsx)(n.li,{children:"Install Ubuntu Server on it"}),"\n",(0,s.jsxs)(n.li,{children:["Login to CloudFlare\u2019s dashboard ",(0,s.jsx)(n.a,{href:"https://dash.cloudflare.com/",children:"here"})]}),"\n",(0,s.jsx)(n.li,{children:"Select Zero Trust from the side menu"}),"\n"]}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"cloudflare zero trust.png",alt:"CloudFlare zero trust login page"}),"\n",(0,s.jsx)(n.p,{children:"Select NETWORKS / Tunnels"}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"cloudlfare tunnels.png",alt:"CloudFlare tunnels page"}),"\n",(0,s.jsx)(n.p,{children:"Click \u201cCreate a tunnel\u201d"}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"create tunnel cloudflare.png",alt:"Create a tunnel"}),"\n",(0,s.jsx)(n.p,{children:"Select CLOUDFLARED"}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"cloudflared.png",alt:"select cloudflared"}),"\n",(0,s.jsx)(n.p,{children:"Name your tunnel then click save tunnel"}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"name cloudflare tunnel.png",alt:"name your tunnel"}),"\n",(0,s.jsxs)(t.A,{children:[(0,s.jsx)(n.p,{children:"The following commands will ONLY work for a VM, if you want to install this on a container, you will need to perform the CT commands specifically.\r\n(use this command within this warning box first before you perform the commands found after!!)"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo apt-get install curl\n"})}),(0,s.jsx)(n.p,{children:"Now you can procede with the normal install commands found below"})]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Select your operating system (we are using Debian)"}),"\n",(0,s.jsx)(n.li,{children:"Copy and paste the install script into the CLI of your CloudFlare VM"}),"\n",(0,s.jsx)(n.li,{children:"After that is done, run the second command to ensure it always starts when the VM reboots."}),"\n"]}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"cloudflare tunnel keys.png",alt:"cloudflare tunnel keys"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Select your domain name you have on CloudFlare"}),"\n",(0,s.jsx)(n.li,{children:"Select the local IP address of your CloudPanel VM and the port of your service (in our case of a Wordpress site it is 443"}),"\n",(0,s.jsxs)(n.li,{children:["put the FQDN of your Wordpress (or other) side in this box. A FQDN is the domain_name_.tld. Example: ",(0,s.jsx)(n.a,{href:"http://Wordpresssite.com",children:"Wordpresssite.com"})," NOT Https://",(0,s.jsx)(n.a,{href:"http://Wordpresssite.com",children:"Wordpresssite.com"})]}),"\n",(0,s.jsx)(n.li,{children:"ENABLE no TLS verify (we are still using TLS all the way through, this just allows for self signed certificated by CloudPanel and CA assigned certificates on CloudFlares side of the tunnel."}),"\n"]}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"set cloudflare tunnel domain and tls.png",alt:"set cloudflare tunnel domain and tls"}),"\n",(0,s.jsx)(n.h2,{id:"blocking-wordpress-admin-from-the-public-internet",children:"Blocking WordPress Admin from the Public Internet"}),"\n",(0,s.jsx)(n.p,{children:"Go back to our CloudPanel dashboard website click SITES, and MANAGE"}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"cloudpanel manage site.png",alt:"cloudpanel manage site"}),"\n",(0,s.jsx)(n.p,{children:"We will add the following block of rules right after the area shown in the red box found in the VHOST tab."}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"vhost cloudpanel settings.png",alt:"vhost cloudpanel settings"}),"\n",(0,s.jsx)(n.p,{children:"Adding these rules will only allow our local network to access the /wp-admin page and then anyone who accesses our public domain_name.com/wp-admin will get a (403 Forbidden) error."}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"nginx 403 forbidden error testing.png",alt:"nginx 403 forbidden error testing"}),"\n",(0,s.jsx)(n.p,{children:"Rules to add:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\r\n    deny 192.168.1.0/32;    # Set to your CloudFlare VM/CT Tunnel IP\r\n    allow 192.168.50.0/24;  # Replace with your actual LAN subnet\r\n    allow 127.0.0.1;        # Allow localhost\r\n    deny all;               # Deny everyone else\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now we just need to restart NGINX on the CloudPanel VM with:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo systemctl restart nginx\n"})}),"\n",(0,s.jsx)(n.h2,{id:"testing-our-wordpress-wp-admin-firewall-rule",children:"Testing our Wordpress wp-admin firewall rule"}),"\n",(0,s.jsx)(n.p,{children:"To ensure we cannot access the Wordpress admin page from the public internet, go to (yourDomainName.com/wp-admin) and ensure you get that 403 forbidden error."}),"\n",(0,s.jsx)(n.h2,{id:"getting-local-wordpress-wp-admin-access",children:"Getting local Wordpress wp-admin Access"}),"\n",(0,s.jsx)(n.p,{children:"Now to get Wordpress wp-admin access, we are going to login to OPNsense / services / Unbound DNS / Overrides"}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"opnsense DNS overrides.png",alt:"opnsense DNS overrides"}),"\n",(0,s.jsx)(n.p,{children:"Select the little plus icon bottom right to add a new entry"}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"add dns override entry.png",alt:"add dns override entry"}),"\n",(0,s.jsx)(n.p,{children:"Then fill out the following settings just as the image shows:"}),"\n",(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"dns override settings.png",alt:"dns override settings"}),"\n",(0,s.jsx)(n.p,{children:"Now attempt to go to your WordPress website domainName.com/wp-admin and you should be able to access it from your local network!"}),"\n",(0,s.jsxs)(t.A,{children:[(0,s.jsx)(n.p,{children:"You may need to flush your DNS during multiple parts of this tutorial to ensure your system is requesting the domain locally and NOT from CloudFlare Tunnel:"}),(0,s.jsx)(n.p,{children:"Open your CLI on your local machine and perform the following:"}),(0,s.jsx)(n.p,{children:"Start with checking where the domain name is resolving to:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"nslookup (your domain name) (your gateway IP, ie. OPNsense IP)\n"})}),(0,s.jsx)(n.p,{children:"Then flush your DNS"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ipconfig /flushdns\n"})}),(0,s.jsx)(n.p,{children:"Then you can do the following"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"nslookup (your domain name) (your gateway IP, ie. OPNsense IP)\n"})}),(0,s.jsx)(n.p,{children:"then ensure you get a response with the server name, address, name, IP:"}),(0,s.jsx)(i.A,{folder:"images/EP42_CloudPanel",name:"nslookup for wordpress site on local dns.png",alt:"nslookup for wordpress site on local dns"})]}),"\n",(0,s.jsx)(t.A,{children:(0,s.jsx)(n.p,{children:"You may also notice the SSL certificate shows NOT SECURE. This is due to setting the DNS override, we are no longer accessing the site internally VIA CloudFlare. If you take your phone off the local wifi, open an incognito tab and go to your domain, you will see it is still secure and trusted!"})}),"\n",(0,s.jsx)(n.h2,{id:"follow-us-on-social-media",children:"Follow Us on Social Media"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://www.youtube.com/@learntohomelab",children:"YouTube"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"https://discord.gg/6MsHSJWZpH",children:"Discord"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"https://www.patreon.com/c/learntohomelab",children:"Patreon"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"https://www.reddit.com/r/learntohomelab/",children:"Reddit"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"https://rumble.com/c/c-7585051",children:"Rumble"})]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}}}]);